<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>FLTK 3.0: Safe widget deletion support functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">FLTK 3.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Safe widget deletion support functions</div>  </div>
</div><!--header-->
<div class="contents">

<p>These functions, declared in &lt;<a class="el" href="run_8h.html" title="fltk3 namespace ">fltk3/run.h</a>&gt;, support deletion of widgets inside callbacks.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga253c943f44e0e18beb024d18c148e25c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fl__del__widget.html#ga253c943f44e0e18beb024d18c148e25c">fltk3::clear_widget_pointer</a> (<a class="el" href="classfltk3_1_1Widget.html">fltk3::Widget</a> const *w)</td></tr>
<tr class="memdesc:ga253c943f44e0e18beb024d18c148e25c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears a widget pointer <em>in</em> the watch list.  <a href="#ga253c943f44e0e18beb024d18c148e25c">More...</a><br/></td></tr>
<tr class="separator:ga253c943f44e0e18beb024d18c148e25c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga501077e124bc15b6054f8cbd2538cea8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fl__del__widget.html#ga501077e124bc15b6054f8cbd2538cea8">fltk3::delete_widget</a> (<a class="el" href="classfltk3_1_1Widget.html">fltk3::Widget</a> *w)</td></tr>
<tr class="memdesc:ga501077e124bc15b6054f8cbd2538cea8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Schedules a widget for deletion at the next call to the event loop.  <a href="#ga501077e124bc15b6054f8cbd2538cea8">More...</a><br/></td></tr>
<tr class="separator:ga501077e124bc15b6054f8cbd2538cea8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf1c5a0136aeafbcd4987a3fbe357373c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fl__del__widget.html#gaf1c5a0136aeafbcd4987a3fbe357373c">fltk3::do_widget_deletion</a> ()</td></tr>
<tr class="memdesc:gaf1c5a0136aeafbcd4987a3fbe357373c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes widgets previously scheduled for deletion.  <a href="#gaf1c5a0136aeafbcd4987a3fbe357373c">More...</a><br/></td></tr>
<tr class="separator:gaf1c5a0136aeafbcd4987a3fbe357373c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6e371d65bcaebbb326113701e959a184"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fl__del__widget.html#ga6e371d65bcaebbb326113701e959a184">fltk3::release_widget_pointer</a> (<a class="el" href="classfltk3_1_1Widget.html">fltk3::Widget</a> *&amp;w)</td></tr>
<tr class="memdesc:ga6e371d65bcaebbb326113701e959a184"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases a widget pointer from the watch list.  <a href="#ga6e371d65bcaebbb326113701e959a184">More...</a><br/></td></tr>
<tr class="separator:ga6e371d65bcaebbb326113701e959a184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeecb286d69227539cd27b5accbb0f8f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fl__del__widget.html#gaeecb286d69227539cd27b5accbb0f8f1">fltk3::watch_widget_pointer</a> (<a class="el" href="classfltk3_1_1Widget.html">fltk3::Widget</a> *&amp;w)</td></tr>
<tr class="memdesc:gaeecb286d69227539cd27b5accbb0f8f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a widget pointer to the widget watch list.  <a href="#gaeecb286d69227539cd27b5accbb0f8f1">More...</a><br/></td></tr>
<tr class="separator:gaeecb286d69227539cd27b5accbb0f8f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>These functions, declared in &lt;<a class="el" href="run_8h.html" title="fltk3 namespace ">fltk3/run.h</a>&gt;, support deletion of widgets inside callbacks. </p>
<p><a class="el" href="group__fl__del__widget.html#ga501077e124bc15b6054f8cbd2538cea8" title="Schedules a widget for deletion at the next call to the event loop. ">fltk3::delete_widget()</a> should be called when deleting widgets or complete widget trees (<a class="el" href="classfltk3_1_1Group.html" title="The fltk3::Group class is the FLTK container widget. ">fltk3::Group</a>, <a class="el" href="classfltk3_1_1Window.html" title="This widget produces an actual window. ">fltk3::Window</a>, ...) inside callbacks.</p>
<p>The other functions are intended for internal use. The preferred way to use them is by using the helper class <a class="el" href="classfltk3_1_1WidgetTracker.html" title="This class should be used to control safe widget deletion. ">fltk3::WidgetTracker</a>.</p>
<p>The following is to show how it works ...</p>
<p>There are three groups of related methods:</p>
<ol type="1">
<li>scheduled widget deletion</li>
</ol>
<ul>
<li><a class="el" href="group__fl__del__widget.html#ga501077e124bc15b6054f8cbd2538cea8" title="Schedules a widget for deletion at the next call to the event loop. ">fltk3::delete_widget()</a> schedules widgets for deletion</li>
<li><a class="el" href="group__fl__del__widget.html#gaf1c5a0136aeafbcd4987a3fbe357373c" title="Deletes widgets previously scheduled for deletion. ">fltk3::do_widget_deletion()</a> deletes all scheduled widgets</li>
</ul>
<ol type="1">
<li>widget watch list ("smart pointers")</li>
</ol>
<ul>
<li><a class="el" href="group__fl__del__widget.html#gaeecb286d69227539cd27b5accbb0f8f1" title="Adds a widget pointer to the widget watch list. ">fltk3::watch_widget_pointer()</a> adds a widget pointer to the watch list</li>
<li><a class="el" href="group__fl__del__widget.html#ga6e371d65bcaebbb326113701e959a184" title="Releases a widget pointer from the watch list. ">fltk3::release_widget_pointer()</a> removes a widget pointer from the watch list</li>
<li><a class="el" href="group__fl__del__widget.html#ga253c943f44e0e18beb024d18c148e25c" title="Clears a widget pointer in the watch list. ">fltk3::clear_widget_pointer()</a> clears a widget pointer <em>in</em> the watch list</li>
</ul>
<ol type="1">
<li>the class <a class="el" href="classfltk3_1_1WidgetTracker.html" title="This class should be used to control safe widget deletion. ">fltk3::WidgetTracker</a>:</li>
</ol>
<ul>
<li>the constructor calls <a class="el" href="group__fl__del__widget.html#gaeecb286d69227539cd27b5accbb0f8f1" title="Adds a widget pointer to the widget watch list. ">fltk3::watch_widget_pointer()</a></li>
<li>the destructor calls <a class="el" href="group__fl__del__widget.html#ga6e371d65bcaebbb326113701e959a184" title="Releases a widget pointer from the watch list. ">fltk3::release_widget_pointer()</a></li>
<li>the access methods can be used to test, if a widget has been deleted <dl class="section see"><dt>See Also</dt><dd><a class="el" href="classfltk3_1_1WidgetTracker.html" title="This class should be used to control safe widget deletion. ">fltk3::WidgetTracker</a>. </dd></dl>
</li>
</ul>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga253c943f44e0e18beb024d18c148e25c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fltk3::clear_widget_pointer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfltk3_1_1Widget.html">fltk3::Widget</a> const *&#160;</td>
          <td class="paramname"><em>w</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears a widget pointer <em>in</em> the watch list. </p>
<p>This is called when a widget is destroyed (by its destructor). You should never call this directly.</p>
<dl class="section note"><dt>Note</dt><dd>Internal use only !</dd></dl>
<p>This method searches the widget watch list for pointers to the widget and clears each pointer that points to it. <a class="el" href="classfltk3_1_1Widget.html" title="fltk3::Widget is the base class for all widgets in FLTK. ">Widget</a> pointers can be added to the widget watch list by calling <a class="el" href="group__fl__del__widget.html#gaeecb286d69227539cd27b5accbb0f8f1" title="Adds a widget pointer to the widget watch list. ">fltk3::watch_widget_pointer()</a> or by using the helper class <a class="el" href="classfltk3_1_1WidgetTracker.html" title="This class should be used to control safe widget deletion. ">fltk3::WidgetTracker</a> (recommended).</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__fl__del__widget.html#gaeecb286d69227539cd27b5accbb0f8f1" title="Adds a widget pointer to the widget watch list. ">fltk3::watch_widget_pointer()</a> </dd>
<dd>
class <a class="el" href="classfltk3_1_1WidgetTracker.html" title="This class should be used to control safe widget deletion. ">fltk3::WidgetTracker</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga501077e124bc15b6054f8cbd2538cea8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fltk3::delete_widget </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfltk3_1_1Widget.html">fltk3::Widget</a> *&#160;</td>
          <td class="paramname"><em>wi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Schedules a widget for deletion at the next call to the event loop. </p>
<p>Use this method to delete a widget inside a callback function.</p>
<p>To avoid early deletion of widgets, this function should be called toward the end of a callback and only after any call to the event loop (<a class="el" href="namespacefltk3.html#a541733012d24b25a080b88dabcc03ece" title="Waits until &quot;something happens&quot; and then returns. ">fltk3::wait()</a>, <a class="el" href="namespacefltk3.html#a105e0036971e3dd802d782c3ba3fdc02" title="Causes all the windows that need it to be redrawn and graphics forced out through the pipes...">fltk3::flush()</a>, <a class="el" href="namespacefltk3.html#af59b3396ba481287d420d662ee04ca1e" title="Same as fltk3::wait(0). ">fltk3::check()</a>, <a class="el" href="group__group__comdlg.html#ga25abbc02c89ee4d53b30bab904fe9afe" title="Shows a dialog displaying a message as a question. ">fltk3::ask()</a>, etc.).</p>
<p>When deleting groups or windows, you must only delete the group or window widget and not the individual child widgets.</p>
<dl class="section since"><dt>Since</dt><dd>FLTK 1.3 it is not necessary to remove widgets from their parent groups or windows before calling this, because it will be done in the widget's destructor, but it is not a failure to do this nevertheless.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>In FLTK 1.1 you <b>must</b> remove widgets from their parent group (or window) before deleting them.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd>fltk3::Widget::~Fl_Widget() </dd></dl>

</div>
</div>
<a class="anchor" id="gaf1c5a0136aeafbcd4987a3fbe357373c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fltk3::do_widget_deletion </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes widgets previously scheduled for deletion. </p>
<p>This is for internal use only. You should never call this directly.</p>
<p><a class="el" href="group__fl__del__widget.html#gaf1c5a0136aeafbcd4987a3fbe357373c" title="Deletes widgets previously scheduled for deletion. ">fltk3::do_widget_deletion()</a> is called from the FLTK event loop or whenever you call <a class="el" href="namespacefltk3.html#a541733012d24b25a080b88dabcc03ece" title="Waits until &quot;something happens&quot; and then returns. ">fltk3::wait()</a>. The previously scheduled widgets are deleted in the same order they were scheduled by calling <a class="el" href="group__fl__del__widget.html#ga501077e124bc15b6054f8cbd2538cea8" title="Schedules a widget for deletion at the next call to the event loop. ">fltk3::delete_widget()</a>.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__fl__del__widget.html#ga501077e124bc15b6054f8cbd2538cea8" title="Schedules a widget for deletion at the next call to the event loop. ">fltk3::delete_widget(fltk3::Widget *wi)</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga6e371d65bcaebbb326113701e959a184"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fltk3::release_widget_pointer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfltk3_1_1Widget.html">fltk3::Widget</a> *&amp;&#160;</td>
          <td class="paramname"><em>w</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Releases a widget pointer from the watch list. </p>
<p>This is used to remove a widget pointer that has been added to the watch list with <a class="el" href="group__fl__del__widget.html#gaeecb286d69227539cd27b5accbb0f8f1" title="Adds a widget pointer to the widget watch list. ">fltk3::watch_widget_pointer()</a>, when it is not needed anymore.</p>
<dl class="section note"><dt>Note</dt><dd>Internal use only, please use class <a class="el" href="classfltk3_1_1WidgetTracker.html" title="This class should be used to control safe widget deletion. ">fltk3::WidgetTracker</a> instead.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__fl__del__widget.html#gaeecb286d69227539cd27b5accbb0f8f1" title="Adds a widget pointer to the widget watch list. ">fltk3::watch_widget_pointer()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaeecb286d69227539cd27b5accbb0f8f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fltk3::watch_widget_pointer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfltk3_1_1Widget.html">fltk3::Widget</a> *&amp;&#160;</td>
          <td class="paramname"><em>w</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a widget pointer to the widget watch list. </p>
<dl class="section note"><dt>Note</dt><dd>Internal use only, please use class <a class="el" href="classfltk3_1_1WidgetTracker.html" title="This class should be used to control safe widget deletion. ">fltk3::WidgetTracker</a> instead.</dd></dl>
<p>This can be used, if it is possible that a widget might be deleted during a callback or similar function. The widget pointer must be added to the watch list before calling the callback. After the callback the widget pointer can be queried, if it is NULL. <em>If</em> it is NULL, then the widget has been deleted during the callback and must not be accessed anymore. If the widget pointer is <em>not</em> NULL, then the widget has not been deleted and can be accessed safely.</p>
<p>After accessing the widget, the widget pointer must be released from the watch list by calling <a class="el" href="group__fl__del__widget.html#ga6e371d65bcaebbb326113701e959a184" title="Releases a widget pointer from the watch list. ">fltk3::release_widget_pointer()</a>.</p>
<p>Example for a button that is clicked (from its <a class="el" href="group__fl__events.html#ga614cc1e90af386f6ed5fe66724956879" title="Handle events from the window system. ">handle()</a> method): </p>
<div class="fragment"><div class="line"><a class="code" href="classfltk3_1_1Widget.html">fltk3::Widget</a> *wp = <span class="keyword">this</span>;             <span class="comment">// save &#39;this&#39; in a pointer variable</span></div>
<div class="line"><a class="code" href="group__fl__del__widget.html#gaeecb286d69227539cd27b5accbb0f8f1">fltk3::watch_widget_pointer</a>(wp);      <span class="comment">// add the pointer to the watch list</span></div>
<div class="line">set_changed();                        <span class="comment">// set the changed flag</span></div>
<div class="line">do_callback();                        <span class="comment">// call the callback</span></div>
<div class="line"><span class="keywordflow">if</span> (!wp) {                            <span class="comment">// the widget has been deleted</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">// DO NOT ACCESS THE DELETED WIDGET !</span></div>
<div class="line"></div>
<div class="line">} <span class="keywordflow">else</span> {                              <span class="comment">// the widget still exists</span></div>
<div class="line">  clear_changed();                    <span class="comment">// reset the changed flag</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__fl__del__widget.html#ga6e371d65bcaebbb326113701e959a184">fltk3::release_widget_pointer</a>(wp);    <span class="comment">// remove the pointer from the watch list</span></div>
</div><!-- fragment --><p>This works, because all widgets call <a class="el" href="group__fl__del__widget.html#ga253c943f44e0e18beb024d18c148e25c" title="Clears a widget pointer in the watch list. ">fltk3::clear_widget_pointer()</a> in their destructors.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__fl__del__widget.html#ga6e371d65bcaebbb326113701e959a184" title="Releases a widget pointer from the watch list. ">fltk3::release_widget_pointer()</a> </dd>
<dd>
<a class="el" href="group__fl__del__widget.html#ga253c943f44e0e18beb024d18c148e25c" title="Clears a widget pointer in the watch list. ">fltk3::clear_widget_pointer()</a></dd></dl>
<p>An easier and more convenient method to control widget deletion during callbacks is to use the class <a class="el" href="classfltk3_1_1WidgetTracker.html" title="This class should be used to control safe widget deletion. ">fltk3::WidgetTracker</a> with a local (automatic) variable.</p>
<dl class="section see"><dt>See Also</dt><dd>class <a class="el" href="classfltk3_1_1WidgetTracker.html" title="This class should be used to control safe widget deletion. ">fltk3::WidgetTracker</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- BEGIN FLTK HTML_FOOTER -->
 <!-- Generated for FLTK 3.0 by Doxygen -->
   <li class="footer">
     <!-- Generated for FLTK 3.0 by Doxygen -->
     &copy; 1998-2011 by Bill Spitzak and others. &nbsp;&nbsp;&nbsp;
     <a href="http://www.fltk.org"><img src="tiny.png" align="bottom" alt="FLTK"></a>
   </li>
  </ul>
 </div>
<hr class="footer"/>
<address class="footer"><small>
  <div align="left">
    <a href="http://www.fltk.org"><img src="tiny.png" align="bottom" alt="FLTK"></a>
    &copy; 1998-2011 by Bill Spitzak and others.&nbsp;&nbsp;&nbsp;
    Permission is granted to reproduce this manual or any portion for
    any purpose, provided this copyright and permission notice are preserved.
  </div>
</small></address>
<!-- END FLTK HTML_FOOTER (/body and /html follows...) -->
</body>
</html>
